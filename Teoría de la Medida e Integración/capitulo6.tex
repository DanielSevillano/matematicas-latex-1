\chapter{El Teorema del Cambio de Variables}

\begin{prop}
Sea $T: \mathbb{R}^n \longrightarrow \mathbb{R}^n$ un isomorfismo lineal y sea A un conjunto medible-Borel. Entonces T(A) es medible-Borel y $m(T(A)) = |det(T)|m(A)$.
\end{prop}

\begin{proof}
Ya sabemos que $T(A)$ es medible-Borel. Veamos la igualdad.
\\
\newline
Caso I. Supongamos que
\begin{align*}
    T(x_1,...,x_j,...,x_n) = (x_1,...,x_{j-1},cx_j,x_{j+1},...,x_n), \ \ \ c \in \mathbb{R}, c \not = 0.
\end{align*}
Es claro que $\det(T) = c$. Para este caso, ya vios que 
\begin{align*}
    |1| \cdots |1|\cdot |c| \cdot |1| \cdots |1|m(A) = |det(T)|m(A).
\end{align*}
Caso II. Supongamos que existen $j, k \in \{1,...,n\}$, $j \not = k$ y $c \in \mathbb{R}$ tales que
\begin{align*}
    T(x_1,...,x_j,...,x_n) = (x_1,...,x_{j-1},x_j +cx_k,x_{j+1},...,x_n).
\end{align*}
Es claro que $|\det(T)| = 1$. Por comodidad en la demostración, vamos a suponer que $j = 1$. Así
\begin{align*}
    T(x_1,x_2,...,x_n) = (x_1 +cx_k,x_2,...,x_n).
\end{align*}
Consideramos que $\mathbb{R}^n = \mathbb{R} \times \mathbb{R}^{n-1}$ y aplicamos el Principio de Cavalieri
\begin{align*}
    m(T(A)) = \int_{\mathbb{R}^{n-1}}{m(T(E))^{(x_2,...,x_n)}) \ dm_{n-1}(x_2,...,x_n)}.
\end{align*}
Ahora bien,
\begin{align*}
    (T(A))^{(x_2,...,x_n)} &= \{ x \in \mathbb{R} : (x,x_2,...,x_n) \in T(A) \} \\
    &= \{ x \in \mathbb{R} : x = x_1 + cx_k, (x_1,x_2,...,x_n) \in A \} \\
    &= \{x \in \mathbb{R} : x = x_1 + cx_k, x_1 \in A^{(x_2,...,x_n)} \} \\
    &= A^{(x_2,...,x_n)} + cx_k.
\end{align*}
Como la medida de Lebesgue es invariante frente a traslaciones, $m(T(E))^{(x_2,...,x_n)} = m(E^{(x_2,...,x_n)})$. Por lo tanto, aplicando de nuevo el Principio de Cavalieri.
\begin{align*}
    m(T(E)) &= \int_{\mathbb{R}^{n-1}}{m(T(A))^{(x_2,...,x_n)}) \ dm_{n-1}(x_2,...,x_n)} \\
    &= \int_{\mathbb{R}^{n-1}}{m(A^{(x_2,...,x_n)}) \ dm_{n-1}(x_2,...,x_n)} = m(A).
\end{align*}
Por tanto, $m(T(A)) = |1|\cdot m(A)$.
\\
\newline 
Caso III. Sea $T$ ahora un isomorfismo lineal cualquiera. Entoces existen $T_1,...,T_s$ isomorfisos lineales de los tipos contemplados en los casos I y II tales que  $T = T_1 \circ \cdots \circ T_s$. Así
\begin{align*}
    m(T(A)) &= m(T_1(T_2(...(T_s(A))))) = |\det(T_1)|m(T_2(T_3(...(T_s(A))) \\
    &= |\det(T_1)| \cdots |\det(T_s)|m(A) = |\det(T)|m(A).
\end{align*}
\end{proof}

\begin{prop}
Sea $T: \mathbb{R}^n \longrightarrow \mathbb{R}^n$ un isomorfismo lineal y sea A un conjunto medible-Lebesgue. Entonces T(A) es medible-Lebesgue y $m(T(A)) = |det(T)|m(A)$.
\end{prop}

\begin{proof}
Supongamos en primer lugar que $m(A) = 0$. Entonces existe un conjunto medible-Borel $G$ tal que $A \subset G$ y $m(G) = 0$. Por la proposición anterior, $m(T(G)) = 0$, y como $T(A) \subset T(G)$, se tiene que $T(A)$ es medible-Lebesgue y $m(T(A)) = 0$, lo que prueba la proposición en este caso.
\\
\newline
Supongamos ahora que $A$ es un conjunto medible-Lebesgue cualquiera. Entonces, existen un conjunto medible-Borel $B$ y un conjuto medible-Lebesgue $N$ tales que
\begin{align*}
    A = B \cup N \text{ y } m(N) = 0 \text{ y, en consecuencia, } m(A) = m(B).
\end{align*}
Entonces,
\begin{align*}
    T(A) = T(B) \cup T(N).
\end{align*}
Por la proposición anterior, $T(B)$ es medible-Borel y $m(T(B)) = |\det(T)|m(B)$. Por el primer caso de esta proposición, $T(N)$ es medible-Lebesgue y $m(T(N)) = 0$. Como $T(A) = T(B) \cup T(N)$, entonces $T(A)$ es medible-Lebesgue y
\begin{align*}
    m(T(A)) = m(T(B)) = |\det(T)|m(B) = |\det(T)|m(E),
\end{align*}
coom queríamos demostrar.
\end{proof}

\begin{obs}
Si $E$ es medible-Lebesgue entonces $\mathcal{X}_{T(E)}$ es medible-Lebesgue y
\begin{align*}
    \int_{\mathbb{R}^n}{\mathcal{X}_{T(E)} \ dm} = |\det(T)|\int_{\mathbb{R}^n}{\mathcal{X}_{E} \ dm}.
\end{align*}
Aplicando el resultado a $T^{-1}$,
\begin{align*}
    \int_{\mathbb{R}^n}{\mathcal{X}_{T^{-1}(E)} \ dm} = |\det(T^{-1})|\int_{\mathbb{R}^n}{\mathcal{X}_{E} \ dm}.
\end{align*}
Nótese que $\mathcal{X}_{T^{-1}(E)}(x) = \mathcal{X}_{E}{(T(x))}$, obtenemos
\begin{align*}
    \int_{\mathbb{R}^n}{\mathcal{X}_E(T(x)) \ dx} = |\det(T^{-1})|\int_{\mathbb{R}^n}{\mathcal{X}_{E} \ dx} = \frac{1}{|\det(T)|}\int_{\mathbb{R}^n}{\mathcal{X}_{E} \ dx}. 
\end{align*}
Es decir, la igualdad
\begin{align*}
    \boxed{
    \int_{\mathbb{R}^n}{f(x) \ dx} = |\det(T)|\int_{\mathbb{R}^n}{f(T(x)) \ dx},
    }
\end{align*}
es válida para funciones características. Por la linealidad de la integral se sigue que también se da para funciones f simples, medibles y no negativas. Aplicando el Teorema de la Convergencia Monótona concluimos que la igualdad es válida para funciones medibles no negativas. Por último, aplicándolo a las partes positiva y negativa de $f$, concluimos que si $f$ es integrable entonces $g(x) = f(T(x))$ es integrable y la igualdad es válida. El mismo resultado se da para funciones complejas. En realidad, se observa que $f$ es integrable si y sólo si $g(x) = f(T(x))$ es integrable.
\\
\newline
En conclusión, la igualdad es válida para $f$ integrable o $f$ medible no negativa. Dicha igualdad es el Teorema del cambio de variable para transformaciones lineales. En la próxima sección daremos el Teorema para aplicaciones más generales
\end{obs}

\section{El Teorema del Cambio de Variables}

\begin{teo}[Teorema del Cambio de Variables]
Sea $\Omega$ un abierto de $\mathbb{R}^n$, y sea $G: \Omega \longrightarrow \mathbb{R}^n$ una función inyectiva tal que $G \in \mathscr{C}^1(\Omega, \mathbb{R}^n)$ y $\det(DG(x)) \not = 0$ para todo $x \in \Omega$.
\begin{enumerate}
    \item[(a)] Si $f: G(\Omega) \longrightarrow [0,+\infty]$ es medible entonces $(f \circ G)$ y $(f \circ G)|\det(DG)|$ son medibles en $\Omega$ y
    \begin{align*}
        \int_{G(\Omega)}{f(x) \ dx} = \int_{\Omega}{(f \circ G)(x)|\det(DG(x))| \ dx}.
    \end{align*}
    \item[(b)] Sea $f: G(\Omega) \longrightarrow \rcom$. La función $f$ es integrable en $G(\Omega)$ si y solo si $(f \circ G)|\det(DG)|$ es integrable en $\Omega$ y, en ese caso,
    \begin{align*}
        \int_{G(\Omega)}{f(x) \ dx} = \int_{\Omega}{(f \circ G)(x)|\det(DG(x))| \ dx}.
    \end{align*}
    \item[(c)] Si $E \subset \Omega$ es un conjunto medible, entonces $G(E)$ es medible y
    \begin{align*}
        m(G(E)) = \int_{E}{|\det(DG(x))| \ dx}.
    \end{align*}
    \item[(d)] Si $E \subset \Omega$ es un conjunto medible, y $f: G(\Omega) \longrightarrow \mathbb{R}$ es medible no negativa entonces $(f \circ G)$ y $(f \circ G)|\det(DG)|$ son medibles en $E$ y 
    \begin{align*}
        \int_{G(E)}{f(x) \ dx} = \int_{E}{(f \circ G)(x)|\det(DG(x))| \ dx}.
    \end{align*}
     \item[(e)] Sean $E \subset \Omega$ un conjunto medible y $f: G(E) \longrightarrow \mathbb{R}$. La función $f$ es integrable en $G(E)$ si y solo si $(f \circ G)|\det(DG)|$ es integrable en $E$ y, en ese caso,
    \begin{align*}
        \int_{G(E)}{f(x) \ dx} = \int_{E}{(f \circ G)(x)|\det(DG(x))| \ dx}.
    \end{align*}
\end{enumerate}
\end{teo}

\section{Cambio de variables afín}
Sea $b \in \mathbb{R}^n$ y sea $T: \mathbb{R}^n \longrightarrow \mathbb{R}^n$ lineal e invertible. Sea $G : \mathbb{R}^n \longrightarrow \mathbb{R}^n$, $G(t) = b + T(t)$. Por lo tanto, $\det(DG(t)) = \det(T)$. Aplicando el cambio de variables para $f: \mathbb{R}^n \longrightarrow \mathbb{R}$ medible y no negativa o integrable, tenemos
\begin{align*}
    \int_{\mathbb{R}^n}{f(x) \ dx} = \int_{\mathbb{R}^n}{f(b + T(t))|\det(T)| \ dt} = |\det(T)|\int_{\mathbb{R}^n}{f(b + T(t)) \ dt}.
\end{align*}

\section{Coordenadas esféricas}

\subsection{Coordenadas polares en $\mathbb{R}^2$}

El cambio a coordenadas polares toma la forma siguiente:
\begin{align*}
    x_1 &= \rho \cos(\varphi) \\ 
    x_2 &= \rho \sen(\varphi),
\end{align*}
donde $(\rho, \varphi) \in \Delta_2 = (0,+\infty)\times(-\pi,\pi)$. En los términos del teorema de cambio de variables, estamos haciendo lo que sigue. Definimos y $\Phi_2 : \Delta_2 \longrightarrow \mathbb{R}^2$ como
\begin{align*}
    \Phi_2(\rho, \varphi) = (\rho \cos(\varphi), \rho \sen(\varphi)).
\end{align*}
Es fácil ver que $\det(D\Phi_2(\rho, \varphi)) = \rho > 0$.

\subsection{Coordenadas esféricas en $\mathbb{R}^3$}
El cambio a coordenadas esféricas toma la forma siguiente:
\begin{align*}
    x_1 &= \rho \cos(\varphi_1) \\
    x_2 &= \rho \sen(\varphi_1) \cos(\varphi_2) \\
    x_3 &= \rho \sen(\varphi_1) \sen(\varphi_2), 
\end{align*}
donde $(\rho, \varphi_2, \varphi_2) \in \Delta_3 = (0,+\infty)\times(0,\pi)\times(-\pi,\pi)$. En los términos del teorema de cambio de variables, estamos haciendo lo que sigue. Definimos $\Phi_3 : \Delta_3 \longrightarrow \mathbb{R}^3$ como
\begin{align*}
    \Phi_3(\rho, \varphi_1, \varphi_2) = (\rho \cos(\varphi_1), \rho \sen(\varphi_1) \cos(\varphi_2), \rho \sen(\varphi_1) \sen(\varphi_2)).
\end{align*}
Se puede comprobar que $\det(D\Phi_3(\rho, \varphi_1, \varphi_2)) = \rho^2 \sen(\varphi_1) > 0$.

\subsection{Coordenadas esféricas en $\mathbb{R}^n$, $n \ge 3$}
El cambio de coordenadas esféricas en $\mathbb{R}^n$, $n \ge 3$ es una generalización de lo visto anteriormente, y toma la forma siguiente:
\begin{align*}
    x_1 &= \rho \cos(\varphi_1) \\
    x_2 &= \rho \sen(\varphi_1) \cos(\varphi_2) \\
        & \vdots \\
    x_{n-1} &=  \rho \sen(\varphi_1) ... \sen(\varphi_{n-2}) \cos(\varphi_{n-2})\\
    x_{n} &=  \rho \sen(\varphi_1) ...\sen(\varphi_{n-2}) \sen(\varphi_{n-1}),
\end{align*}
donde $(\rho, \varphi_1,..,\varphi_{n-2},\varphi_{n-1}) \in \Delta_n = (0,+\infty)\times(0,\pi)^{n-2}\times(-\pi,\pi)$. Definimos $\Phi_n : \Delta_n \longrightarrow \mathbb{R}^n$ como
\begin{align*}
    \Phi_n(\rho, \varphi_1,..,\varphi_{n-2},\varphi_{n-1}) = (x_1,x_2,...,x_{n-1},x_n).
\end{align*}
Se puede comprobar que
\begin{align*}
    \det(D\Phi_n(\rho, \varphi_1,..,\varphi_{n-1})) = \rho^{n-1}\prod_{i=1}^{n-2}{(\sen(\varphi_i))^{n-1-i}} > 0.
\end{align*}

\subsection{La fórmula del cambio de variables simplificada}
Pongamos que
\begin{align*}
    S^{n-1} = (0,\pi)^{n-2}\times(-\pi,\pi).
\end{align*}
Así
\begin{align*}
    \Delta_n = (0,+\infty)\times S^{n-1}.
\end{align*}
Denotemos por $\varphi$ al vector $\varphi_1,...,\varphi_{n-1}$ y sea
\begin{align*}
    s_{n-1} : S^{n-1} \longrightarrow \mathbb{R}, \ \ \ s_{n-1}(\varphi) = \prod_{i=1}^{n-2}{(\sen(\varphi_i))^{n-1-i}}.
\end{align*}
Como se ve, $s_{n-1}(\varphi)$ es independiente de $\varphi_{n-1}$. Con esta notación,
\begin{align*}
    \det(D\Phi_n(\rho,\varphi_1,...,\varphi_{n-1})) = p^{n-1}s_{n-1}(\varphi).
\end{align*}
Luego, el cambio de variables nos dice que para $f \ge 0$ o $f$ integrable
\begin{align*}
    \int_{\mathbb{R}^n}{f(x) \ dx} &= \int_{\Delta_n}{f(\Phi_n(\rho, \varphi))p^{n-1}s_{n-1}(\varphi) \ d(\rho, \varphi)} \\
    &= \int_{0}^{\infty} \rho^{n-1}\left( \int_{S^{n-1}}{f(\Phi_n(\rho, \varphi))s_{n-1}(\varphi) \ d\varphi} \right) \ d\rho \\
    &= \int_{S^{n-1}}  s_{n-1}(\varphi)\left( \int_{0}^{\infty}{\rho^{n-1}f(\Phi_n(\rho, \varphi))(\varphi) \ d\rho} \right) \ d\varphi.
\end{align*}

\subsection{Cálculo de la medida de la bola unidad}
Sea $B(0,1) \subset \mathbb{R}^n$ la bola cerrada (o abierta) de centro 0 y radio 1. Aplicando el cambio de coordenadas esféricas y empleando esta útlima notación,
\begin{align*}
    m(B(0,1)) = \int_{S^{n-1}} s_{n-1}(\varphi)\left( \int_{0}^{1}{\rho^{n-1} \ d\rho} \right) \ d\varphi = \frac{1}{n}\int_{S^{n-1}} s_{n-1}(\varphi) \ d\varphi
\end{align*}
Si ponemos
\begin{align*}
    \omega_n = \frac{1}{n}\int_{S^{n-1}} s_{n-1}(\varphi) \ d\varphi,
\end{align*}
obtenemos que 
\begin{align*}
    m(B(0,1)) = \frac{\omega_n}{n}.
\end{align*}
Se puede comprobar que
\begin{align*}
    \omega_n = \frac{2\pi^{n/2}}{\Gamma\left( \frac{n}{2} \right)}.
\end{align*}
De aquí deducimos que
\begin{align*}
    m(B(0,1)) = \frac{\omega_n}{n} = \frac{\pi^{n/2}}{\frac{n}{2} \Gamma\left( \frac{n}{2} \right)} = \frac{\pi^{n/2}}{\Gamma\left( \frac{n}{2} + 1 \right)}.
\end{align*}